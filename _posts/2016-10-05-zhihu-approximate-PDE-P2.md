---
layout: post
title: "变分法近似解法 Part 2.--Strong Form Galerkin"
subtitle: "Strong Form Galerkin"
author: "Yue"
header-mask: 0
header-style: text
catalog: true
mathjax: true
tags:
  - 计算力学
  - 应用数学
  - 有限元
---

> 这篇文章转载自[我在知乎上的专栏文章](https://zhuanlan.zhihu.com/p/22457731)


2.Strong Form Galerkin(序号接着上篇文章)

上一篇Part 1.介绍了Rayleigh-Ritz法。一句话概括下就是：将泛函数中的待求函数设成带有未知系数的已知形式（如多项式），并将其带入原泛函数，从而将最小化泛函数的问题简化成我们熟悉的最小化函数问题来求解未知系数，最后就得出了待求函数的近似解。而这次文章以及下次文章要说到的强形式和弱形式（Strong form & Weak form Galerkin）法是从求解PDE出发的。**类似于Rayleigh-Ritz法的思路，我们可以把PDE的解近似为一系列基函数的叠加（需要满足边界条件）**。例如如果我们要解这样一个PDE：$A[w(x)]-f=0$,其中$A[w(x)$]代表对待求函数$w(x)$的任意微分运算，例如$A[w(x)]=\frac{\partial^2w}{\partial x^2}$ 。那么我们可以用公式写出这个PDE的近似解为：

$\tilde{w}(x)=\phi_0(x)+\sum_{j=1}^{n}{c_j\phi_j(x)}$

其中$\phi_j (x)$是已知的基函数(basis functions), $c_j$是待解的未知系数。$\phi_0(x)$是用来满足非其次边界条件的，下面会结合例子说明。

很显然，除非精确解恰巧和我们设的近似解形式相同，不然近似解是和精确解有偏差的。换句话说，如果我们把近似解$\tilde{w}(x)$带入原PDE，那么将不会等于0，会带来一些残差或余量。用公式表示就是$A[\tilde{w}(x)]-f=R\ne 0$。**这样问题就转化为求解出$\mathbf{c_j}$使得余量R在求解域上尽可能小（尽可能接近0），这样我们的近似解越逼近于精确解**。

这时候我们需要使用加权余量法(Method of Weighted Residual)。这种方法的基本思想是，既然不能找到准确解使余量R在整个求解域上都完全等于零，那么我们至少要找到一个近似解使余量R在求解域上的某种平均等于零。说到某种平均第一反应会是将R在求解域上积分，即令$\int R dx=0$，但这其实是个比较糟糕的想法，满足这个式子的有无穷种可能性，根本不可解。合理的做法是令R的加权积分为零，写成公式即：

$\int R(x)\Phi_i(x)dx=0\ \ \ (i=1,...,n)$

其中$\Phi_i$是权函数(weighted function)。权函数的选择有多种方法，这里介绍的同时也是有限元中常用的一种是Galerkin method。该方法将近似解中的基函数$\phi_i$直接当做权函数$\Phi_i$(一个用大写的phi一个用小写的phi，有没有一种钦定的感觉)。这样做的好处是，独立等式的数量（即$\phi_i$的数量）和待解$c_j$的数量相同，这样就能确保未知系数$c_j$唯一且可解。解出$c_j$后带入$\tilde{w}(x)$ 就可以得到近似解啦。

还是用上一篇文章的Example. 2为例，这次使用Strong Form Galerkin。以仅用一个未知系数为例。


---------------------------------------------------------------------------------------------------------------------------

Example. 2

$I[y(x);x]=\int_{0}^{2}[0.5(y'')^2+5(y')^2+2y^2+y]dx-10y(0)$

Essential Boundary Conditions: $y(2)=0$； $y'(0)=-2$

Natural Boundary Conditions: $y'''(0)=-10$； $y''(2)=0$

求解最小化泛函数$I$的解$y(x)$。

---------------------------------------------------------------------------------------------------------------------------

解：

首先大家可以用变分法证明下最小化泛函数I的解和下面这个PDE的解是等价的。

$y''''-10y''+4y+1=0, \ \ 0<x<2$，（加上上述题目中的边界条件）

基本思路是写出I的一阶变分$\delta I=\int^2_0 [y''\delta (y'')+10y'\delta(y')+4y\delta y+\delta y] dx$,然后再分部积分，即可得到$\delta I=\int^2_0 (y''''-10y''+4y+1)\delta y\  dx+\text{Boundary terms}$。【注1】

总之现在问题就变成使用Strong Form Galerkin求解一个带有边界条件的PDE。回顾下文章开头，第一步是设出PDE的近似解，我们一般采用多项式形式。这里要注意，使用Strong Form Galerkin的时候，设的近似解既要满足Essential boundary condition又要满足Natural Boundary condition。也就是说在本例中，四个边界条件都需要满足。假设我们只用一个未知系数，那么这个多项式必须要是四次的，即：

$\tilde{y}=a_1x^4+a_2x^3+a_3x^2+a_4x+a_5$

因为为了满足边界条件我们可以列出四个等式，然后上式有五个未知系数，等于最终我们只有一个未知系数。现在我们将边界条件带入近似解：

$\tilde{y} (2)=0;\ \ \tilde{y}'(0)=-2;\ \ \tilde{y}'''(0)=-10;\ \ \ \tilde{y}''(2)=0,$

可以解得：

$\tilde{y}(x)=-\frac{5}{3}x^3+10x^2-2x-\frac{68}{3} +a_4(x^4-24x^2+80)$

上式中，$-\frac{5}{3}x^3+10x^2-2x-\frac{68}{3}$ 是$\phi_0$，然后$a_4$是$c_1$; 最后$(x^4-24x^2+80)$ 是$\phi_1$。

接着计算残差或者余量：

$R=\tilde{y}''''-10\tilde{y}''+4\tilde{y}$，可见$R$是$a_4$和$x$的函数。

最后计算加权积分：

$\int^2_0[(\tilde{y}''''-10\tilde{y}''+4\tilde{y}+1)(x^4-24x^2+80)]dx=0$

上式仅有一个未知数$a_4$，可以解得其值为0.2985，所以最终求得的近似解是：

$\tilde{y}(x)=-\frac{5}{3}x^3+10x^2-2x-\frac{68}{3} +0.2985(x^4-24x^2+80)$

我用Matlab简单画了下上述近似解和精确解的比较，有没有很失望啊。这是由于我们只用了一个未知系数，如果用两个甚至更多的话，近似解是十分逼近精确解的，有兴趣的可以自行尝试~

![img](/img/in-post/FEM/Strong_Form_img1.png)

---------------------------------------------------------------------------------------------------------------------------

【注1】
下面两个等式是由分部积分得来的：

$\int^2_0 [y''\delta y''] dx=\int^2_0[y''''\delta y] dx-y'''\delta y\Big|_0^2+y''\delta y'\|_0^2$

$\int_0^2 [10y'\delta y'] dx=10(-\int^2_0[y''\delta y] dx+y'\delta y\|^2_0)$

注1之前的那个式子是把所有积分项合并，然后其余边界项统一称为Boundary terms得到的。
