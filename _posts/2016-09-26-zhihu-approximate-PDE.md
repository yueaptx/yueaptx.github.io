---
layout: post
title: "变分法近似解法 Part 1.--Rayleigh-Ritz Method"
subtitle: "Rayleigh-Ritz Method"
author: "Yue"
header-mask: 0
header-style: text
catalog: true
mathjax: true
tags:
  - 计算力学
  - 应用数学
  - 有限元
---

> 这篇文章转载自[我在知乎上的专栏文章](https://zhuanlan.zhihu.com/p/20882021)

本文需要用到之前“变分法简介”的两篇文章作为基础。这篇算是接着那两篇的。

变分法简介 Part 2.那篇文章中说到了用最小化泛函数的方法求解问题，最终可以将问题转化为求解一个带有边界条件的偏微分方程(PDE)的问题。但是实际上并不是所有的PDE都像上次那个两点间最短距离问题中的PDE那么好解，这也就是为什么我们要有有限元方法，因为有限元可以避开求解复杂偏微分方程，用相对简单的方法来求解其近似解。一般有三种近似方法，分别是**Rayleigh-Ritz method, Strong Form Galerkin (SFG) 和 Weak Form Galerkin (WFG)**。后两者就是我们常听说的貌似比较高大上的强形式和弱形式。后面会分别介绍和比较这三种方法。以后的文章会介绍如何将他们运用于有限元方法。

在最开始，首先要理清一个非常重要的思路。那就是通过变分法最小化泛函数得到的PDE和原泛函数之间的关系。如果理清了这个关系，上述三种方法的基本思想就算是掌握了，剩下的就是一些数学而已了。它们之间的关系是：**PDE的解是能将原泛函数最小化的函数**。这层关系给我们提供了两条路走——1.直接从泛函数出发，找出可以最小化它的函数。2.通过变分法得到PDE，然后求解PDE（近似求解），这样得到的PDE的解（或近似解）就是方法1中所要求的函数。上面提到的三种方法就是顺着这两条路走的。Rayleigh-Ritz对应于第一条路，强弱形式对应于后一条路。看上去Rayleigh-Ritz法和求解微分方程并没有什么关系，因为它跳过了通过变分法得到PDE这个步骤，但是根据上面提到的关系，我们可以把思维逆转过来，即能将泛函数最小化的函数是使用变分法后得到的PDE的解。这样我们也可以强行把Rayleigh-Ritz法看成是近似求解微分方程的方法。

（本来想一篇文章介绍完三种方法的，但是写完第一种方法后发现文章已经很长了，剩下的两种方法就下篇文章继续介绍吧。）

1.Rayleigh-Ritz Method

第一条路看似是更直接的捷径，但是世界上有无穷种函数，直接找出可以最小化一个泛函数的函数谈何容易。但是如果我们先假设一下这个函数的形式，那么未知的就只是一些系数了，再将这个假设的函数带入原泛函数，就可以将泛函数转化为未知系数的函数，而最小化函数对我们而言是轻而易举的（对未知系数求导等于零），解出未知系数后带入假设的函数，就得到了最小化泛函数的近似解。这就是Rayleigh-Ritz Method的基本思想。一般来说，我们会将近似函数的形式设为多项式(polynomial)，例如$y(x)=a_0+a_1x+a_2x^2\cdot \cdot \cdot $，这也是有限元里常用的形式。话不多说，看个简单的例子：

Example. 1

![img](/img/in-post/FEM/Rayleigh_Ritz_img1.png)

如上图，拉伸一个横截面积为A，长为L，杨氏模量为E的杆，最右端的力为P，位移为$u_0$。我们想要用最小势能原理解出其位移场$u(x)$。虽然很明显精确解是$u(x)=\frac{u_0}{L}x$ ，但是就像之前的两点间直线最短的例子一样，例子虽然简单，但是可以帮助我们感受下这个方法的过程。

我们可以写出系统势能（具体为什么是这个式子之后的文章会解释，这次着重于介绍方法的思想）：$\Pi=\frac{1}{2}\int_{0}^{L}  EA(u')^2dx-Pu_0$。

由于左端固定，右端位移已知，所以有两个Essential Boundary Conditions: $u\|_{x=0}=0$。

根据上文的思路，我们设待求函数$u(x)$的形式为多项式$\tilde{u}(x)=a_0+a_1x+a_2x^2$ 。这里姑且先设成二次形式。一般来说，设的次数越高，近似解越精确，但是由于本例精确解就是个一次线性方程，所以只要设的函数高于1次，近似解就和精确解相同。另一个需要注意的是，使用Rayleigh-Ritz法时，**设的近似方程（如本例中的$\tilde{u}(x)$ ）必须满足Essential Boundary Conditions(不必须满足Natural Boundary Condition)**。遵循这点，我们可以得出两个等式：

$\tilde{u}(0)=0$  和 $\tilde{u}(L)=u_0$

由上述两式可以解出$a_0=0$以及$a_1L+a_2L^2=u_0\Rightarrow a_2=\frac{u_0-a_1L}{L^2}$，将这两个结果带入$\tilde{u}(x)$ 整理下得到：$\tilde{u}(x)=\frac{u_0}{L^2}x^2+a_1(x-\frac{x^2}{L})$。也就是说我们只有1个未知参数$a_1$。

通常我们会将$\tilde{u}(x)$ 写成$\tilde{u}(x)=\phi_0(x)+\sum_{j=1}^{n}{c_j\phi_j(x)}$ 的形式。对应这个例子，$\phi_0=\frac{u_0}{L^2}x^2 , c_1=a_1, \phi_1=\frac{x}{L}(L-x)$ ，如果有更多未知参数，则会有更高阶项。$\phi_i$有个**重要的性质**：从$\phi_1$开始，所有的$\phi_i$在Essential Boundary Condition处都等于零。比如这个例子中，在x=0和x=L处有Essential Boundary Condition,那么$\phi_1$在x=0和x=L处必须等于零，我们可以发现确实满足，如果有更高阶项$\phi_2$, $\phi_3$等等，同样应该满足。这个性质可以帮助我们检查近似函数设的是否正确。现在需要做的就是把$\tilde{u}(x)$ 带入到原泛函数中，即用$\tilde{u}(x)$ 取代$u(x)$。

$\tilde{u}'(x)=\frac{2u_0}{L^2}x+c_1(1-\frac{2x}{L} )$

$\Pi=\frac{1}{2}\int_{0}^{L}EA(\tilde{u}'(x) )^2dx-Pu_0=\frac{EA}{2} (\frac{4u_0^2}{3L} +\frac{c_1^2L}{3}-\frac{2u_0c_1}{3} )-Pu_0$

这样，$\Pi$就仅是$c_1$的函数而已，那么最小化$\Pi(c_1)$就非常简单了，即令$\frac{d\Pi}{dc_1}=0$ :

$\frac{d\Pi}{dc_1}=\frac{2}{3}c_1L- \frac{2}{3}u_0=0$ ,

解得$c_1=\frac{u_0}{L}$。带入$\tilde{u}(x)$ 得到$\tilde{u}(x)=\frac{u_0}{L}x$  。可以看到这和精确解一致。这是由于所设的近似方程的形式恰巧和精确解方程的形式一样，但是大多数问题中，精确解一般都不是多项式，所以如果将近似函数设为多项式，则会产生误差，得出的结果则是近似解。

上面这个例子并不能令人感到兴奋，因为本身就是一眼就能看出精确解的问题硬生生算了半天，感觉很傻，所以再举个稍微复杂点的例子感受下。

Example. 2 

$I[y(x);x]=\int_{0}^{2}[0.5(y'')^2+5(y')^2+2y^2+y]dx-10y(0)$ ,

Essential Boundary Conditions: $y(2)=0; y'(0)=-2$

Natural Boundary Conditions: $y'''(0)=-10; y''(2)=0$

有兴趣的可以用Rayleigh-Ritz方法求解下可以最小化泛函数I的近似解函数$\tilde{y} (x)$。我有空会把求解过程补上，准备使用2个未知参数。

下次的文章会接着介绍Strong Form和Weak Form Galerkin。为了方便对比各种方法的结果，我会用上面的Example. 2做例子。


